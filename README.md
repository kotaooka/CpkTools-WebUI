# CpkTools-WebUI

CpkTools WebUI は、Excel ファイルから工程能力解析を実施できるツールです。  
ユーザーは Excel ファイルをアップロードし、解析対象の列を選択、各列ごとの上限規格値と下限規格値を入力して、  
各種統計値（最大値、最小値、標準偏差、平均値、Cp、Cpk、尖度、歪度）を計算および
グラフ（ヒストグラム、QQプロット）の生成を行います。  
結果は Excel ファイルに出力され、Web UI 上にプレビュー表示されます。

## 実行例
![image](https://github.com/user-attachments/assets/473b3a8f-c92e-494f-909e-977a0d8ba90c)![image](https://github.com/user-attachments/assets/2f229a14-06fc-488d-a712-7c3b86393fc5)

## 目次

- [要求環境](#要求環境)
- [インストール方法](#インストール方法)
  - [1. Python のインストール (Windows)](#1-python-の-インストール-windows)
  - [2. リリースファイルのダウンロード](#2-リリースファイルのダウンロード)
  - [3. setup.bat を実行して仮想環境の構築とライブラリのインストール](#3-setupbat-を-実行して-仮想環境の構築とライブラリのインストール)
- [CpkTools-WebUI の起動と使用方法](#cpktools-webui-の-起動と-使用方法)
- [注意事項](#注意事項)
- [ライセンス](#ライセンス)

## 要求環境

- **OS**: Windows  
- **Python**: Python 3.x  
- **必要な Python ライブラリ**: pandas, pyarrow, matplotlib, scipy, Pillow, gradio, numpy

## インストール方法

### 1. Python のインストール (Windows)

Python をインストールしていない場合は、以下のリンクから最新の Python 3.x をダウンロードしてください。  
※ インストール時に「Add Python to PATH」にチェックを入れることを推奨します。

- [Python 公式ダウンロードページ (Windows)](https://www.python.org/downloads/windows/)

### 2. リリースファイルのダウンロード

本プロジェクトの最新リリースは [GitHub Releases](https://github.com/kotaooka/CpkTools-WebUI/releases) ページからダウンロードできます。  
ダウンロードした ZIP ファイルを展開し、任意のフォルダ（例：`D:\CpkTools-WebUI`）に保存してください。

### 3. setup.bat を実行して仮想環境の構築とライブラリのインストール

ダウンロードまたは解凍したプロジェクトフォルダ内にある `setup.bat` を実行します。  
このバッチファイルは、プロジェクト専用の Python 仮想環境を作成し、必要なライブラリのインストールを自動で行います。

## CpkTools-WebUI の起動と使用方法

### 1. CpkTools-Webui.bat を実行してアプリケーションを起動

同じフォルダ内にある `CpkTools-WebUI.bat` を実行することで、アプリケーションが起動します。  
実行後、ブラウザが自動的に開き、**Gradio** を用いたユーザーインターフェースが表示されます。

**プロキシ設定が必要な環境の場合はCpkTools-WebUI.batファイルに以下のコードを追加してください。**
```
  set HTTP_PROXY=http://あなたのアドレス:ポート番号
  set HTTPS_PROXY=https://あなたのアドレス:ポート番号
  set NO_PROXY=localhost,127.0.0.1
```

### 2. Excel ファイルのアップロード

「**Excelファイル**」アップロードボックスに対象の Excel ファイル（`.xlsx` または `.xls`）を選択してください。  
アップロード後、ファイルの先頭 5 行がプレビュー表示され、利用可能な列がドロップダウンリストに表示されます。

### 3. 解析対象の列選択

表示されたドロップダウンリストから、**解析対象の列**を選択してください（複数選択可）。

### 4. 各列の規格値入力

選択した列に基づいて、下部に自動生成される「**各列の規格値入力**」テーブルが表示されます。  
テーブルには以下の項目が含まれます：

- **解析対象**: 選択された列名  
- **規格上限値**: 各列ごとの上限規格値  
- **規格下限値**: 各列ごとの下限規格値

すべての列で同一の規格値を使用する場合は、「**すべての列の規格値を同じにする**」チェックボックスを ON にしてください。  
チェックボックスが有効になると、**1 列目の規格値が自動的に全列にコピー**されます。

### 5. 解析開始

入力内容に問題がなければ、「**解析開始**」ボタンをクリックしてください。  
すると、各列に対する統計計算（**最大値、最小値、標準偏差、平均値、Cp、Cpk、尖度、歪度**）と**グラフ生成**が行われ、解析結果のログが画面上に表示されます。

### 6. 結果の確認とダウンロード

- 統計結果は、画面上の**結果プレビュー**と**Excel プレビュー領域**に表示されます。  
- 生成された Excel ファイルは、`output`フォルダに出力され、**ダウンロードリンク**からも取得できます。  
- 各列の**ヒストグラム**と**QQ プロット**も表示され、解析内容を視覚的に確認できます。

## 注意事項

- アップロードする Excel ファイルに**有効なデータ**が含まれていること、解析対象の列に**欠損値がない**ことを確認してください。
- 規格値入力は**正しい数値形式**で行ってください。すべての列で同じ規格値を使用する場合は、まず**1 列目に正確な値**を入力してからチェックボックスを ON にしてください。

## ライセンス

本プロジェクトは **MIT License** の下で提供されています。  
詳細はプロジェクトルートの `LICENSE` ファイルをご確認ください.
